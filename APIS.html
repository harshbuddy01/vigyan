<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üîí Vigyan Complete API Tester</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            color: #333;
        }

        .security-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }

        .login-box {
            background: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
            text-align: center;
            max-width: 400px;
        }

        .login-box h2 {
            color: #dc2626;
            margin-bottom: 20px;
        }

        .login-box input {
            width: 100%;
            padding: 12px;
            margin: 10px 0;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1em;
        }

        .login-box button {
            width: 100%;
            padding: 12px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1.1em;
            cursor: pointer;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            display: none;
        }

        .container.unlocked {
            display: block;
        }

        h1 {
            color: #667eea;
            margin-bottom: 20px;
        }

        .top-controls {
            background: #1f2937;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .top-controls label {
            color: #10b981;
            font-weight: bold;
            display: block;
            margin-bottom: 8px;
        }

        .top-controls input {
            width: 100%;
            padding: 10px;
            background: #374151;
            border: 2px solid #4b5563;
            color: #10b981;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            margin-bottom: 15px;
        }

        .test-all-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1.2em;
            font-weight: bold;
            cursor: pointer;
            margin: 10px 0;
        }

        .test-all-btn:hover {
            background: linear-gradient(135deg, #059669, #047857);
        }

        .section {
            margin: 30px 0;
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            overflow: hidden;
        }

        .section-header {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .section-header h2 {
            margin: 0;
            font-size: 1.3em;
        }

        .test-section-btn {
            padding: 8px 20px;
            background: #10b981;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
        }

        .test-section-btn:hover {
            background: #059669;
        }

        .section-content {
            padding: 20px;
            background: #f9fafb;
        }

        .api-item {
            background: white;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border: 1px solid #e5e7eb;
        }

        .api-header {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .method {
            padding: 5px 12px;
            border-radius: 5px;
            font-weight: bold;
            color: white;
            font-size: 0.85em;
        }

        .method-get {
            background: #10b981;
        }

        .method-post {
            background: #3b82f6;
        }

        .method-put {
            background: #f59e0b;
        }

        .method-delete {
            background: #ef4444;
        }

        .path {
            font-family: 'Courier New', monospace;
            color: #667eea;
            flex: 1;
            font-size: 0.95em;
        }

        .auth-badge {
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 0.75em;
            background: #fbbf24;
            color: #92400e;
        }

        .auth-admin {
            background: #dc2626;
            color: white;
        }

        .test-btn {
            padding: 6px 15px;
            background: #10b981;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.85em;
        }

        .test-btn:hover {
            background: #059669;
        }

        .response {
            margin-top: 10px;
            padding: 10px;
            background: #1f2937;
            color: #10b981;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 0.85em;
            max-height: 200px;
            overflow-y: auto;
            display: none;
        }

        .response.show {
            display: block;
        }

        .response.error {
            color: #ef4444;
        }

        .status-bar {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #1f2937;
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            display: none;
        }

        .status-bar.show {
            display: block;
        }
    </style>
</head>

<body>
    <!-- Security Login -->
    <div class="security-overlay" id="securityOverlay">
        <div class="login-box">
            <h2>üîí Admin Access Required</h2>
            <p style="color: #666; margin-bottom: 20px;">Password: vigyan_admin_2026</p>
            <input type="password" id="accessPassword" placeholder="Enter admin password">
            <button onclick="checkAccess()">Unlock API Tester</button>
        </div>
    </div>

    <!-- Main Container -->
    <div class="container" id="mainContainer">
        <h1>üöÄ Vigyan Complete API Tester (33 Endpoints)</h1>
        <button onclick="logout()"
            style="float: right; padding: 8px 15px; background: #dc2626; color: white; border: none; border-radius: 6px; cursor: pointer;">Logout</button>
        <div style="clear: both;"></div>

        <!-- Top Controls -->
        <div class="top-controls">
            <label>API Base URL:</label>
            <input type="text" id="baseURL" value="https://vigyan-production.up.railway.app">

            <!-- ‚úÖ REMOVED: JWT Token input - Now using cookie-based authentication -->

            <button class="test-all-btn" onclick="testAllAPIs()">üß™ TEST ALL APIS (33 endpoints)</button>
        </div>

        <!-- Status Bar -->
        <div class="status-bar" id="statusBar">Testing...</div>

        <!-- 1. AUTHENTICATION APIs -->
        <div class="section">
            <div class="section-header">
                <h2>üîê Authentication APIs (3)</h2>
                <button class="test-section-btn" onclick="testSection('auth')">Test Section</button>
            </div>
            <div class="section-content">
                <div class="api-item">
                    <div class="api-header">
                        <span class="method method-post">POST</span>
                        <span class="path">/api/admin/auth/login</span>
                        <button class="test-btn" onclick="testAPI('auth_login')">Test</button>
                    </div>
                    <input type="text" id="auth_login_username" placeholder="username" value="admin"
                        style="width: 48%; padding: 8px; margin: 5px 1% 5px 0; border: 1px solid #ddd; border-radius: 4px;">
                    <input type="password" id="auth_login_password" placeholder="password"
                        style="width: 48%; padding: 8px; margin: 5px 0; border: 1px solid #ddd; border-radius: 4px;">
                    <div class="response" id="response_auth_login"></div>
                </div>

                <div class="api-item">
                    <div class="api-header">
                        <span class="method method-post">POST</span>
                        <span class="path">/api/admin/auth/logout</span>
                        <button class="test-btn" onclick="testAPI('auth_logout')">Test</button>
                    </div>
                    <div class="response" id="response_auth_logout"></div>
                </div>

                <div class="api-item">
                    <div class="api-header">
                        <span class="method method-post">POST</span>
                        <span class="path">/api/admin/auth/validate-session</span>
                        <button class="test-btn" onclick="testAPI('auth_validate')">Test</button>
                    </div>
                    <div class="response" id="response_auth_validate"></div>
                </div>
            </div>
        </div>

        <!-- 2. EXAM & TEST APIs -->
        <div class="section">
            <div class="section-header">
                <h2>üìù Exam & Test APIs (4)</h2>
                <button class="test-section-btn" onclick="testSection('exam')">Test Section</button>
            </div>
            <div class="section-content">
                <div class="api-item">
                    <div class="api-header">
                        <span class="method method-get">GET</span>
                        <span class="path">/api/exam/scheduled-tests</span>
                        <span class="auth-badge auth-admin">Admin</span>
                        <button class="test-btn" onclick="testAPI('exam_scheduled')">Test</button>
                    </div>
                    <div class="response" id="response_exam_scheduled"></div>
                </div>

                <div class="api-item">
                    <div class="api-header">
                        <span class="method method-post">POST</span>
                        <span class="path">/api/exam/getUserInfo</span>
                        <button class="test-btn" onclick="testAPI('exam_userinfo')">Test</button>
                    </div>
                    <input type="text" id="exam_userinfo_email" placeholder="email@example.com"
                        style="width: 100%; padding: 8px; margin: 5px 0; border: 1px solid #ddd; border-radius: 4px;">
                    <div class="response" id="response_exam_userinfo"></div>
                </div>

                <div class="api-item">
                    <div class="api-header">
                        <span class="method method-post">POST</span>
                        <span class="path">/api/exam/start</span>
                        <button class="test-btn" onclick="testAPI('exam_start')">Test</button>
                    </div>
                    <div class="response" id="response_exam_start"></div>
                </div>

                <div class="api-item">
                    <div class="api-header">
                        <span class="method method-post">POST</span>
                        <span class="path">/api/exam/submit</span>
                        <button class="test-btn" onclick="testAPI('exam_submit')">Test</button>
                    </div>
                    <div class="response" id="response_exam_submit"></div>
                </div>
            </div>
        </div>

        <!-- 3. PAYMENT APIs -->
        <div class="section">
            <div class="section-header">
                <h2>üí≥ Payment APIs (3)</h2>
                <button class="test-section-btn" onclick="testSection('payment')">Test Section</button>
            </div>
            <div class="section-content">
                <div class="api-item">
                    <div class="api-header">
                        <span class="method method-get">GET</span>
                        <span class="path">/api/payment/getkey</span>
                        <button class="test-btn" onclick="testAPI('payment_getkey')">Test</button>
                    </div>
                    <div class="response" id="response_payment_getkey"></div>
                </div>

                <div class="api-item">
                    <div class="api-header">
                        <span class="method method-post">POST</span>
                        <span class="path">/api/payment/checkout</span>
                        <button class="test-btn" onclick="testAPI('payment_checkout')">Test</button>
                    </div>
                    <div class="response" id="response_payment_checkout"></div>
                </div>

                <div class="api-item">
                    <div class="api-header">
                        <span class="method method-post">POST</span>
                        <span class="path">/api/payment/paymentverification</span>
                        <button class="test-btn" onclick="testAPI('payment_verify')">Test</button>
                    </div>
                    <div class="response" id="response_payment_verify"></div>
                </div>
            </div>
        </div>

        <!-- 4. ANALYTICS APIs -->
        <div class="section">
            <div class="section-header">
                <h2>üìä Analytics APIs (2) - ‚úÖ Now Secured</h2>
                <button class="test-section-btn" onclick="testSection('analytics')">Test Section</button>
            </div>
            <div class="section-content">
                <div class="api-item">
                    <div class="api-header">
                        <span class="method method-post">POST</span>
                        <span class="path">/api/analytics/payment-event</span>
                        <span class="auth-badge">User JWT</span>
                        <button class="test-btn" onclick="testAPI('analytics_event')">Test</button>
                    </div>
                    <div class="response" id="response_analytics_event"></div>
                </div>

                <div class="api-item">
                    <div class="api-header">
                        <span class="method method-post">POST</span>
                        <span class="path">/api/analytics/payment-failed</span>
                        <span class="auth-badge">User JWT</span>
                        <button class="test-btn" onclick="testAPI('analytics_failed')">Test</button>
                    </div>
                    <div class="response" id="response_analytics_failed"></div>
                </div>
            </div>
        </div>

        <!-- 5. USER PROFILE APIs -->
        <div class="section">
            <div class="section-header">
                <h2>üë§ User Profile APIs (2) - ‚úÖ Now Secured</h2>
                <button class="test-section-btn" onclick="testSection('user')">Test Section</button>
            </div>
            <div class="section-content">
                <div class="api-item">
                    <div class="api-header">
                        <span class="method method-get">GET</span>
                        <span class="path">/api/user/profile</span>
                        <span class="auth-badge">User JWT</span>
                        <button class="test-btn" onclick="testAPI('user_profile')">Test</button>
                    </div>
                    <div class="response" id="response_user_profile"></div>
                </div>

                <div class="api-item">
                    <div class="api-header">
                        <span class="method method-get">GET</span>
                        <span class="path">/api/user/check-purchase/:testId</span>
                        <span class="auth-badge">User JWT</span>
                        <button class="test-btn" onclick="testAPI('user_check')">Test</button>
                    </div>
                    <input type="text" id="user_check_testid" placeholder="testId (e.g., IISER_2025)" value="IISER_2025"
                        style="width: 100%; padding: 8px; margin: 5px 0; border: 1px solid #ddd; border-radius: 4px;">
                    <div class="response" id="response_user_check"></div>
                </div>
            </div>
        </div>

        <!-- 6. ADMIN DASHBOARD APIs -->
        <div class="section">
            <div class="section-header">
                <h2>üìà Admin Dashboard APIs (3)</h2>
                <button class="test-section-btn" onclick="testSection('dashboard')">Test Section</button>
            </div>
            <div class="section-content">
                <div class="api-item">
                    <div class="api-header">
                        <span class="method method-get">GET</span>
                        <span class="path">/api/admin/dashboard/stats</span>
                        <span class="auth-badge auth-admin">Admin</span>
                        <button class="test-btn" onclick="testAPI('dashboard_stats')">Test</button>
                    </div>
                    <div class="response" id="response_dashboard_stats"></div>
                </div>

                <div class="api-item">
                    <div class="api-header">
                        <span class="method method-get">GET</span>
                        <span class="path">/api/admin/dashboard/performance</span>
                        <span class="auth-badge admin-admin">Admin</span>
                        <button class="test-btn" onclick="testAPI('dashboard_performance')">Test</button>
                    </div>
                    <div class="response" id="response_dashboard_performance"></div>
                </div>

                <div class="api-item">
                    <div class="api-header">
                        <span class="method method-get">GET</span>
                        <span class="path">/api/admin/dashboard/recent-activity</span>
                        <span class="auth-badge auth-admin">Admin</span>
                        <button class="test-btn" onclick="testAPI('dashboard_activity')">Test</button>
                    </div>
                    <div class="response" id="response_dashboard_activity"></div>
                </div>
            </div>
        </div>

        <!-- 7. QUESTION MANAGEMENT APIs -->
        <div class="section">
            <div class="section-header">
                <h2>‚ùì Question Management APIs (4)</h2>
                <button class="test-section-btn" onclick="testSection('questions')">Test Section</button>
            </div>
            <div class="section-content">
                <div class="api-item">
                    <div class="api-header">
                        <span class="method method-post">POST</span>
                        <span class="path">/api/admin/questions</span>
                        <span class="auth-badge auth-admin">Admin</span>
                        <button class="test-btn" onclick="testAPI('questions_add')">Test</button>
                    </div>
                    <div class="response" id="response_questions_add"></div>
                </div>

                <div class="api-item">
                    <div class="api-header">
                        <span class="method method-get">GET</span>
                        <span class="path">/api/admin/questions?testId=...</span>
                        <span class="auth-badge auth-admin">Admin</span>
                        <button class="test-btn" onclick="testAPI('questions_get')">Test</button>
                    </div>
                    <input type="text" id="questions_get_testid" placeholder="testId" value="IISER_2025"
                        style="width: 100%; padding: 8px; margin: 5px 0; border: 1px solid #ddd; border-radius: 4px;">
                    <div class="response" id="response_questions_get"></div>
                </div>

                <div class="api-item">
                    <div class="api-header">
                        <span class="method method-put">PUT</span>
                        <span class="path">/api/admin/questions/:id</span>
                        <span class="auth-badge auth-admin">Admin</span>
                        <button class="test-btn" onclick="testAPI('questions_update')">Test</button>
                    </div>
                    <div class="response" id="response_questions_update"></div>
                </div>

                <div class="api-item">
                    <div class="api-header">
                        <span class="method method-delete">DELETE</span>
                        <span class="path">/api/admin/questions/:id</span>
                        <span class="auth-badge auth-admin">Admin</span>
                        <button class="test-btn" onclick="testAPI('questions_delete')">Test</button>
                    </div>
                    <div class="response" id="response_questions_delete"></div>
                </div>
            </div>
        </div>

        <!-- 8. PDF PROCESSING APIs -->
        <div class="section">
            <div class="section-header">
                <h2>üìÑ PDF Processing APIs (6)</h2>
                <button class="test-section-btn" onclick="testSection('pdf')">Test Section</button>
            </div>
            <div class="section-content">
                <div class="api-item">
                    <div class="api-header">
                        <span class="method method-post">POST</span>
                        <span class="path">/api/pdf/upload</span>
                        <span class="auth-badge auth-admin">Admin</span>
                        <button class="test-btn" onclick="testAPI('pdf_upload')">Test</button>
                    </div>
                    <div class="response" id="response_pdf_upload"></div>
                </div>

                <div class="api-item">
                    <div class="api-header">
                        <span class="method method-get">GET</span>
                        <span class="path">/api/pdf/history</span>
                        <span class="auth-badge auth-admin">Admin</span>
                        <button class="test-btn" onclick="testAPI('pdf_history')">Test</button>
                    </div>
                    <div class="response" id="response_pdf_history"></div>
                </div>

                <div class="api-item">
                    <div class="api-header">
                        <span class="method method-delete">DELETE</span>
                        <span class="path">/api/pdf/:id</span>
                        <span class="auth-badge auth-admin">Admin</span>
                        <button class="test-btn" onclick="testAPI('pdf_delete')">Test</button>
                    </div>
                    <div class="response" id="response_pdf_delete"></div>
                </div>

                <div class="api-item">
                    <div class="api-header">
                        <span class="method method-post">POST</span>
                        <span class="path">/api/pdf-ai/extract</span>
                        <button class="test-btn" onclick="testAPI('pdfai_extract')">Test</button>
                    </div>
                    <div class="response" id="response_pdfai_extract"></div>
                </div>

                <div class="api-item">
                    <div class="api-header">
                        <span class="method method-post">POST</span>
                        <span class="path">/api/pdf-ai/convert-questions</span>
                        <button class="test-btn" onclick="testAPI('pdfai_convert')">Test</button>
                    </div>
                    <div class="response" id="response_pdfai_convert"></div>
                </div>

                <div class="api-item">
                    <div class="api-header">
                        <span class="method method-post">POST</span>
                        <span class="path">/api/pdf-ai/full-process</span>
                        <button class="test-btn" onclick="testAPI('pdfai_full')">Test</button>
                    </div>
                    <div class="response" id="response_pdfai_full"></div>
                </div>
            </div>
        </div>

        <!-- 9. RESULTS APIs -->
        <div class="section">
            <div class="section-header">
                <h2>üìä Results APIs (5)</h2>
                <button class="test-section-btn" onclick="testSection('results')">Test Section</button>
            </div>
            <div class="section-content">
                <div class="api-item">
                    <div class="api-header">
                        <span class="method method-get">GET</span>
                        <span class="path">/api/admin/results</span>
                        <span class="auth-badge auth-admin">Admin</span>
                        <button class="test-btn" onclick="testAPI('results_all')">Test</button>
                    </div>
                    <div class="response" id="response_results_all"></div>
                </div>

                <div class="api-item">
                    <div class="api-header">
                        <span class="method method-get">GET</span>
                        <span class="path">/api/admin/results/:id</span>
                        <span class="auth-badge auth-admin">Admin</span>
                        <button class="test-btn" onclick="testAPI('results_single')">Test</button>
                    </div>
                    <div class="response" id="response_results_single"></div>
                </div>

                <div class="api-item">
                    <div class="api-header">
                        <span class="method method-get">GET</span>
                        <span class="path">/api/admin/results/stats/overview</span>
                        <span class="auth-badge auth-admin">Admin</span>
                        <button class="test-btn" onclick="testAPI('results_stats')">Test</button>
                    </div>
                    <div class="response" id="response_results_stats"></div>
                </div>

                <div class="api-item">
                    <div class="api-header">
                        <span class="method method-get">GET</span>
                        <span class="path">/api/admin/results/stats/distribution</span>
                        <span class="auth-badge auth-admin">Admin</span>
                        <button class="test-btn" onclick="testAPI('results_distribution')">Test</button>
                    </div>
                    <div class="response" id="response_results_distribution"></div>
                </div>

                <div class="api-item">
                    <div class="api-header">
                        <span class="method method-get">GET</span>
                        <span class="path">/api/admin/results/stats/top-performers</span>
                        <span class="auth-badge auth-admin">Admin</span>
                        <button class="test-btn" onclick="testAPI('results_top')">Test</button>
                    </div>
                    <div class="response" id="response_results_top"></div>
                </div>
            </div>
        </div>

        <!-- 10. NEWS API -->
        <div class="section">
            <div class="section-header">
                <h2>üì∞ News APIs (1)</h2>
                <button class="test-section-btn" onclick="testSection('news')">Test Section</button>
            </div>
            <div class="section-content">
                <div class="api-item">
                    <div class="api-header">
                        <span class="method method-get">GET</span>
                        <span class="path">/api/news</span>
                        <button class="test-btn" onclick="testAPI('news_get')">Test</button>
                    </div>
                    <div class="response" id="response_news_get"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const ADMIN_PASSWORD = 'vigyan_admin_2026';

        function checkAccess() {
            if (document.getElementById('accessPassword').value === ADMIN_PASSWORD) {
                document.getElementById('securityOverlay').style.display = 'none';
                document.getElementById('mainContainer').classList.add('unlocked');
                sessionStorage.setItem('apiAuth', 'true');
            } else {
                alert('‚ùå Access Denied!');
            }
        }

        function logout() {
            sessionStorage.removeItem('apiAuth');
            location.reload();
        }

        window.onload = () => {
            if (sessionStorage.getItem('apiAuth') === 'true') {
                document.getElementById('securityOverlay').style.display = 'none';
                document.getElementById('mainContainer').classList.add('unlocked');
            }
        };

        function getBaseURL() { return document.getElementById('baseURL').value.trim(); }
        function getJWT() { return document.getElementById('jwtToken').value.trim(); }

        function showStatus(msg) {
            const bar = document.getElementById('statusBar');
            bar.textContent = msg;
            bar.classList.add('show');
            setTimeout(() => bar.classList.remove('show'), 3000);
        }

        function showResponse(id, data, isError = false) {
            const el = document.getElementById('response_' + id);
            el.classList.add('show');
            el.classList.toggle('error', isError);
            el.innerHTML = `<pre>${JSON.stringify(data, null, 2)}</pre>`;
        }

        async function fetchAPI(url, options = {}) {
            // ‚úÖ FIXED: Use cookie-based authentication instead of Bearer token
            const defaultOptions = {
                credentials: 'include',  // ‚úÖ Send cookies automatically
                headers: {
                    'Content-Type': 'application/json'
                }
            };

            const res = await fetch(url, {
                ...defaultOptions,
                ...options,
                headers: { ...defaultOptions.headers, ...options.headers }
            });

            return { ok: res.ok, data: await res.json() };
        }

        // Individual API Tests
        async function testAPI(id) {
            const base = getBaseURL();
            try {
                let result;
                switch (id) {
                    case 'auth_login':
                        result = await fetchAPI(`${base}/api/admin/auth/login`, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                username: document.getElementById('auth_login_username').value,
                                password: document.getElementById('auth_login_password').value
                            })
                        });
                        break;
                    case 'auth_logout':
                        result = await fetchAPI(`${base}/api/admin/auth/logout`, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ username: 'admin' })
                        });
                        break;
                    case 'auth_validate':
                        result = await fetchAPI(`${base}/api/admin/auth/validate-session`, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ username: 'admin' })
                        });
                        break;
                    case 'exam_scheduled':
                        result = await fetchAPI(`${base}/api/exam/scheduled-tests`);
                        break;
                    case 'exam_userinfo':
                        result = await fetchAPI(`${base}/api/exam/getUserInfo`, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ email: document.getElementById('exam_userinfo_email').value })
                        });
                        break;
                    case 'exam_start':
                        result = await fetchAPI(`${base}/api/exam/start`, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ email: 'test@example.com', rollNumber: '12345' })
                        });
                        break;
                    case 'exam_submit':
                        result = { ok: false, data: { info: 'Requires full exam data - manual test only' } };
                        break;
                    case 'payment_getkey':
                        result = await fetchAPI(`${base}/api/payment/getkey`);
                        break;
                    case 'payment_checkout':
                        result = await fetchAPI(`${base}/api/payment/checkout`, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ amount: 999, testId: 'IISER_2025' })
                        });
                        break;
                    case 'payment_verify':
                        result = { ok: false, data: { info: 'Requires Razorpay signature - manual test only' } };
                        break;
                    case 'analytics_event':
                        result = await fetchAPI(`${base}/api/analytics/payment-event`, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ event: 'initiated', data: { testId: 'TEST' }, timestamp: new Date().toISOString() })
                        });
                        break;
                    case 'analytics_failed':
                        result = await fetchAPI(`${base}/api/analytics/payment-failed`, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ testId: 'TEST', error: 'Test error', timestamp: new Date().toISOString() })
                        });
                        break;
                    case 'user_profile':
                        result = await fetchAPI(`${base}/api/user/profile`);
                        break;
                    case 'user_check':
                        result = await fetchAPI(`${base}/api/user/check-purchase/${document.getElementById('user_check_testid').value}`);
                        break;
                    case 'dashboard_stats':
                        result = await fetchAPI(`${base}/api/admin/dashboard/stats`);
                        break;
                    case 'dashboard_performance':
                        result = await fetchAPI(`${base}/api/admin/dashboard/performance?period=7d`);
                        break;
                    case 'dashboard_activity':
                        result = await fetchAPI(`${base}/api/admin/dashboard/recent-activity`);
                        break;
                    case 'questions_add':
                        result = { ok: false, data: { info: 'Requires full question data - manual test only' } };
                        break;
                    case 'questions_get':
                        result = await fetchAPI(`${base}/api/admin/questions?testId=${document.getElementById('questions_get_testid').value}`);
                        break;
                    case 'questions_update':
                        result = { ok: false, data: { info: 'Requires question ID - manual test only' } };
                        break;
                    case 'questions_delete':
                        result = { ok: false, data: { info: 'Requires question ID - manual test only' } };
                        break;
                    case 'pdf_upload':
                        result = { ok: false, data: { info: 'Requires file upload - manual test only' } };
                        break;
                    case 'pdf_history':
                        result = await fetchAPI(`${base}/api/pdf/history`);
                        break;
                    case 'pdf_delete':
                        result = { ok: false, data: { info: 'Requires PDF ID - manual test only' } };
                        break;
                    case 'pdfai_extract':
                        result = { ok: false, data: { info: 'Requires PDF file - manual test only' } };
                        break;
                    case 'pdfai_convert':
                        result = { ok: false, data: { info: 'Requires text input - manual test only' } };
                        break;
                    case 'pdfai_full':
                        result = { ok: false, data: { info: 'Requires PDF file - manual test only' } };
                        break;
                    case 'results_all':
                        result = await fetchAPI(`${base}/api/admin/results?page=1&limit=10`);
                        break;
                    case 'results_single':
                        result = { ok: false, data: { info: 'Requires result ID - manual test only' } };
                        break;
                    case 'results_stats':
                        result = await fetchAPI(`${base}/api/admin/results/stats/overview`);
                        break;
                    case 'results_distribution':
                        result = await fetchAPI(`${base}/api/admin/results/stats/distribution`);
                        break;
                    case 'results_top':
                        result = await fetchAPI(`${base}/api/admin/results/stats/top-performers?limit=10`);
                        break;
                    case 'news_get':
                        result = await fetchAPI(`${base}/api/news`);
                        break;
                    default:
                        result = { ok: false, data: { error: 'Unknown API' } };
                }
                showResponse(id, result.data, !result.ok);
            } catch (error) {
                showResponse(id, { error: error.message }, true);
            }
        }

        // Test Section
        async function testSection(section) {
            showStatus(`Testing ${section.toUpperCase()} section...`);
            const apis = {
                auth: ['auth_login', 'auth_logout', 'auth_validate'],
                exam: ['exam_scheduled', 'exam_userinfo', 'exam_start', 'exam_submit'],
                payment: ['payment_getkey', 'payment_checkout', 'payment_verify'],
                analytics: ['analytics_event', 'analytics_failed'],
                user: ['user_profile', 'user_check'],
                dashboard: ['dashboard_stats', 'dashboard_performance', 'dashboard_activity'],
                questions: ['questions_add', 'questions_get', 'questions_update', 'questions_delete'],
                pdf: ['pdf_upload', 'pdf_history', 'pdf_delete', 'pdfai_extract', 'pdfai_convert', 'pdfai_full'],
                results: ['results_all', 'results_single', 'results_stats', 'results_distribution', 'results_top'],
                news: ['news_get']
            };

            for (const api of apis[section]) {
                await testAPI(api);
                await new Promise(r => setTimeout(r, 500)); // Delay between requests
            }
            showStatus(`‚úÖ ${section.toUpperCase()} section complete!`);
        }

        // Test All APIs
        async function testAllAPIs() {
            const sections = ['auth', 'exam', 'payment', 'analytics', 'user', 'dashboard', 'questions', 'pdf', 'results', 'news'];
            showStatus('Testing ALL 33 APIs...');
            for (const section of sections) {
                await testSection(section);
            }
            showStatus('‚úÖ ALL 33 APIS TESTED!');
        }

        // Enter key for password
        document.getElementById('accessPassword')?.addEventListener('keypress', e => {
            if (e.key === 'Enter') checkAccess();
        });
    </script>
</body>

</html>